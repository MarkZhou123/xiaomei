version: "3"
services:
  access:
    image: 192.168.202.12:5000/{{ .Domain }}/access
    deploy:
      mode: global
      placement: { constraints: [ node.labels.hasAccess==true ] }
    volumes: [ "logs:/var/log/nginx" ]
    ports: ["80:80"]
  logc:
    image: 192.168.202.12:5000/xiaomei/logc
    command: [ "org-name" ]
    deploy:
      mode: global
    volumes: 
      - "logs:/"
      - "project1_logs:/logs/project1"
      - "project2_logs:/logs/project2"
volumes:
  logs:
  project1_logs:
    external: true
  project2_logs:
    external: true
